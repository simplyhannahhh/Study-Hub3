<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title data-i18n="pageTitle">Study Hub</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --primary-blue: #007bff;
            --accent-orange: #fd7e14;
            --card-bg: #ffffff;
            --border-color: #e9ecef;
            --header-gradient-start: #007bff;
            --header-gradient-end: #00bfff;
            --button-bg: #007bff;
            --button-hover-bg: #0056b3;
            --input-bg: #ffffff;
            --input-text: #343a40;
            --input-placeholder: #6c757d;
            --footer-bg: #343a40;
            --footer-text: #e9ecef;
            --flashcard-q-bg: #e3f2fd;
            --flashcard-a-text: #0056b3;
            --note-article-bg: #fdfdfd;
            --quiz-section-bg: #e6f7ff;
            --download-button-bg: #28a745;
            --download-button-hover-bg: #218838;
            --correct-text: #28a745;
            --correct-bg: rgba(40, 167, 69, 0.1);
            --incorrect-text: #dc3545;
            --incorrect-bg: rgba(220, 53, 69, 0.1);
        }

        body.dark {
            --bg-color: #212529;
            --text-color: #e9ecef;
            --primary-blue: #6610f2;
            --accent-orange: #ffc107;
            --card-bg: #343a40;
            --border-color: #495057;
            --header-gradient-start: #343a40;
            --header-gradient-end: #495057;
            --button-bg: #6610f2;
            --button-hover-bg: #5a00d2;
            --input-bg: #495057;
            --input-text: #e9ecef;
            --input-placeholder: #adb5bd;
            --footer-bg: #1a1e21;
            --footer-text: #ced4da;
            --flashcard-q-bg: #414a51;
            --flashcard-a-text: #b3cde3;
            --note-article-bg: #414a51;
            --quiz-section-bg: #414a51;
            --download-button-bg: #1e7e34;
            --download-button-hover-bg: #155724;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            transition: background-color 0.4s ease, color 0.4s ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        header {
            background: linear-gradient(to right, var(--header-gradient-start), var(--header-gradient-end));
            color: var(--footer-text);
            padding: 1.5rem 30px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 35px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        header h1 {
            margin: 0;
            font-size: 2.8rem;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .header-controls {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 15px; /* Space between controls */
        }

        button {
            padding: 12px 25px;
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        button:hover {
            background-color: var(--button-hover-bg);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.35);
        }

        /* NEW CSS for the Go Back button */
        #quizGoBackButton {
            margin-top: 15px; /* Add some space above it */
            background-color: #6c757d; /* A neutral color */
            color: white;
        }

        #quizGoBackButton:hover {
            background-color: #5a6268;
        }

        body.dark #quizGoBackButton {
            background-color: #adb5bd; /* Lighter color for dark mode */
            color: #212529;
        }

        body.dark #quizGoBackButton:hover {
            background-color: #9098a1;
        }
        /* END NEW CSS */

        input[type="text"] {
            padding: 12px 20px;
            font-size: 1.05rem;
            border: 1px solid var(--border-color);
            border-radius: 30px;
            background-color: var(--input-bg);
            color: var(--input-text);
            box-shadow: inset 0 1px 4px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 4px rgba(0,123,255,0.3);
        }

        input[type="text"]::placeholder {
            color: var(--input-placeholder);
        }

        .language-select {
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--input-text);
            font-size: 1rem;
            cursor: pointer;
            appearance: none; /* Removes default dropdown arrow */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            transition: all 0.3s ease;
        }

        .dark .language-select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%23e9ecef' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        }

        .language-select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(0,123,255,0.2);
        }

        main {
            flex-grow: 1;
            max-width: 1000px;
            margin: 0 auto;
            padding: 25px;
        }

        section {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transition: background-color 0.4s ease, border-color 0.4s ease, box-shadow 0.4s ease, transform 0.2s ease;
        }

        section:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
        }

        h2 {
            color: var(--primary-blue);
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 2.4rem;
            font-weight: 700;
            text-align: center;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 15px;
            position: relative;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 15px;
            background-color: var(--accent-orange);
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(253,126,20,0.5);
        }

        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .card {
            background-color: var(--flashcard-q-bg);
            border: 1px solid var(--border-color);
            padding: 25px;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
            text-align: center;
            font-size: 1.15rem;
            font-weight: 500;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 150px;
        }

        .card p {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .card .answer {
            display: none;
            font-weight: bold;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px dashed var(--border-color);
            color: var(--flashcard-a-text);
            font-size: 1.3rem;
        }

        #notes article {
            background-color: var(--note-article-bg);
            border: 1px solid var(--border-color);
            padding: 30px;
            border-radius: 15px;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.08);
        }

        #notes h3 {
            color: var(--accent-orange);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.8rem;
            font-weight: 600;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        
        #notes p {
            font-size: 1.1rem;
            color: var(--text-color);
            margin-bottom: 1em; /* Add spacing between paragraphs */
        }
        #notes p:last-child {
            margin-bottom: 0; /* No margin after last paragraph */
        }


        .quiz-content {
            background-color: var(--quiz-section-bg);
            border: 1px solid var(--border-color);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        #quiz input[type="text"] {
            margin-bottom: 25px;
            width: 70%;
            max-width: 400px;
        }

        #quizFeedback {
            margin-top: 25px;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            min-height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: transparent;
            transition: background-color 0.3s ease;
        }

        .text-green {
            color: var(--correct-text);
            background-color: var(--correct-bg);
        }

        .text-red {
            color: var(--incorrect-text);
            background-color: var(--incorrect-bg);
        }

        #downloads a {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background-color: var(--download-button-bg);
            color: var(--button-text);
            padding: 18px 35px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.2rem;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
        }

        #downloads a:hover {
            background-color: var(--download-button-hover-bg);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.35);
        }

        footer {
            background-color: var(--footer-bg);
            color: var(--footer-text);
            text-align: center;
            padding: 25px;
            margin-top: 50px;
            font-size: 1rem;
            box-shadow: 0 -6px 12px rgba(0,0,0,0.25);
            border-top-left-radius: 30px;
            border-top-right-radius: 30px;
        }

        @media (max-width: 992px) {
            header { padding: 1.2rem 25px; }
            header h1 { font-size: 2.2rem; }
            .header-controls {
                flex-direction: column;
                width: 100%;
                gap: 10px;
            }
            header button, header input[type="text"], .language-select {
                width: 100%;
            }
            button { padding: 10px 20px; font-size: 1rem; }
            input[type="text"] { padding: 10px 15px; }
            .language-select { padding: 8px 12px; font-size: 0.95rem; }
            main { padding: 20px; }
            section { padding: 30px; margin-bottom: 25px; }
            h2 { font-size: 2rem; margin-bottom: 20px; padding-bottom: 12px; }
            h2::after { bottom: -8px; width: 12px; height: 12px; }
            .card { padding: 20px; font-size: 1.05rem; }
            .card .answer { margin-top: 15px; padding-top: 10px; font-size: 1.1rem; }
            #notes h3 { font-size: 1.6rem; }
            #notes p { font-size: 1rem; }
            #quiz input[type="text"] { width: 85%; }
            #downloads a { padding: 15px 25px; font-size: 1.05rem; }
            footer { padding: 20px; }
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                padding: 1.2rem 20px;
                text-align: center;
            }
            header h1 { margin-bottom: 20px; }
            .header-controls {
                gap: 8px;
            }
            header button, header input[type="text"], .language-select {
                margin-bottom: 5px;
                box-sizing: border-box;
            }
            main { padding: 15px; }
            section { padding: 25px; margin-bottom: 20px; }
            h2 { font-size: 1.8rem; margin-bottom: 18px; padding-bottom: 10px; }
            h2::after { bottom: -7px; width: 10px; height: 10px; }
            .card-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            .card { min-height: 120px; }
            #notes h3 { font-size: 1.5rem; }
            #downloads a { padding: 12px 20px; font-size: 1rem; }
            footer { padding: 15px; margin-top: 30px; }
        }

        @media (max-width: 480px) {
            header { padding: 1rem 15px; }
            header h1 { font-size: 1.6rem; }
            button { font-size: 0.95rem; padding: 10px 18px; }
            input[type="text"] { font-size: 0.95rem; padding: 10px 15px; }
            main { padding: 10px; }
            section { padding: 20px; }
            h2 { font-size: 1.6rem; }
            .card { padding: 18px; }
            .card .answer { font-size: 1.1rem; }
            #notes p { font-size: 0.95rem; }
            #quiz input[type="text"] { width: 95%; }
        }
    </style>
</head>
<body>
    <header>
        <h1 data-i18n="appTitle">📚 Study Hub</h1>
        <div class="header-controls">
            <select id="languageSelector" class="language-select">
                <option value="en">English</option>
                <option value="es">Español</option>
                <option value="fr">Français</option>
                <option value="de">Deutsch</option>
                <option value="it">Italiano</option>
            </select>
            <button id="darkModeToggle" data-i18n="darkModeButton">Dark Mode</button>
            <input type="text" id="searchInput" data-i18n="searchInputPlaceholder" placeholder="Search resources..." />
        </div>
    </header>

    <main>
        <section id="flashcards">
            <h2 data-i18n="flashcardsTitle">Flashcards</h2>
            <div class="card-container">
                <div class="card">
                    <p data-i18n="flashcard1Question">What is the capital of France?</p>
                    <span class="answer" data-i18n="flashcard1Answer">Paris</span>
                </div>
                <div class="card">
                    <p data-i18n="flashcard2Question">2 + 2 = ?</p>
                    <span class="answer" data-i18n="flashcard2Answer">4</span>
                </div>
            </div>
        </section>

        <section id="notes">
            <h2 data-i18n="notesTitle">Study Notes</h2>
            <article>
                <h3 data-i18n="biologyNoteTitle">Biology: The Cell</h3>
                <p data-i18n="biologyNoteContent1"></p>
                <p data-i18n="biologyNoteContent2"></p>
                <p data-i18n="biologyNoteContent3"></p>
                <p data-i18n="biologyNoteContent4"></p>
                <p data-i18n="biologyNoteContent5"></p>
            </article>
        </section>

        <section id="quiz">
            <h2 data-i18n="quizTitle">Mini Quiz</h2>
            <div class="quiz-content">
                <p id="quizQuestionDisplay" data-i18n="quizQuestion"></p>
                <input type="text" id="quizAnswerInput" data-i18n="quizInputPlaceholder" placeholder="Your answer" />
                <button id="quizActionButton" data-i18n="quizStartButton">Start Quiz</button>
                <button id="quizGoBackButton" style="display: none;" data-i18n="quizGoBackButton">Go Back</button> <div id="quizFeedback"></div>
            </div>
        </section>

        <section id="downloads">
            <h2 data-i18n="downloadsTitle">Downloadables</h2>
            <a href="sample.pdf" download data-i18n="downloadLink">📄 Download Sample Notes</a>
        </section>
    </main>

    <footer>
        <p data-i18n="footerText">© 2025 Study Hub</p>
    </footer>

    <script>
        // --- Translations Data ---
        const translations = {
            en: {
                pageTitle: "Study Hub",
                appTitle: "📚 Study Hub",
                darkModeButton: "Dark Mode",
                searchInputPlaceholder: "Search resources...",
                flashcardsTitle: "Flashcards",
                flashcard1Question: "What is the capital of France?",
                flashcard1Answer: "Paris",
                flashcard2Question: "2 + 2 = ?",
                flashcard2Answer: "4",
                notesTitle: "Study Notes",
                biologyNoteTitle: "Biology: The Cell",
                biologyNoteContent1: "The cell is the fundamental unit of life. All living organisms, from the smallest bacteria to the largest whales, are composed of cells. Cells are the basic building blocks, and they carry out all the essential functions necessary for life, such as obtaining nutrients, converting them into energy, and reproducing.",
                biologyNoteContent2: "There are two main types of cells: prokaryotic and eukaryotic. Prokaryotic cells are simpler and older, lacking a nucleus and other membrane-bound organelles. Bacteria and archaea are examples of prokaryotes. Eukaryotic cells, on the other hand, are more complex, possessing a true nucleus that houses their genetic material and various specialized organelles.",
                biologyNoteContent3: "Key organelles in eukaryotic cells include the nucleus, which controls cell growth and reproduction; mitochondria, often called the 'powerhouses' of the cell, responsible for energy production (ATP); the endoplasmic reticulum (ER), involved in protein and lipid synthesis; and the Golgi apparatus, which modifies, sorts, and packages proteins and lipids.",
                biologyNoteContent4: "The cell membrane acts as a protective barrier that regulates what enters and leaves the cell. It's composed of a lipid bilayer with embedded proteins, giving it a 'fluid mosaic' structure. This selective permeability is crucial for maintaining the cell's internal environment.",
                biologyNoteContent5: "Cell division is a vital process. In multicellular organisms, it allows for growth and the repair of damaged tissues. In single-celled organisms, it is the primary method of reproduction. Mitosis is the most common form of cell division for growth and repair, while meiosis is specialized for sexual reproduction.",
                quizTitle: "Mini Quiz",
                quizStartButton: "Start Quiz",
                quizNextButton: "Next Question",
                quizSubmitButton: "Submit Answer", // This will be dynamic based on current state
                quizRetakeButton: "Retake Quiz",
                quizInputPlaceholder: "Your answer",
                quizCorrect: "Correct!",
                quizIncorrect: "Incorrect. The answer was ",
                quizCompleted: "Quiz Completed! You got ",
                quizOutOf: " out of ",
                quizQ1: "What are the two main types of cells?",
                quizA1: "Prokaryotic and eukaryotic",
                quizQ2: "Which organelle is known as the 'powerhouse' of the cell?",
                quizA2: "Mitochondria",
                quizQ3: "What controls cell growth and reproduction?",
                quizA3: "Nucleus",
                quizQ4: "What is the primary function of the cell membrane?",
                quizA4: "Regulates what enters and leaves the cell",
                quizQ5: "What is the most common form of cell division for growth and repair?",
                quizA5: "Mitosis",
                downloadsTitle: "Downloadables",
                downloadLink: "📄 Download Sample Notes",
                footerText: "© 2025 Study Hub",
                quizGoBackButton: "Go Back" // NEW TRANSLATION
            },
            es: {
                pageTitle: "Centro de Estudio",
                appTitle: "📚 Centro de Estudio",
                darkModeButton: "Modo Oscuro",
                searchInputPlaceholder: "Buscar recursos...",
                flashcardsTitle: "Tarjetas de Vocabulario",
                flashcard1Question: "¿Cuál es la capital de Francia?",
                flashcard1Answer: "París",
                flashcard2Question: "2 + 2 = ?",
                flashcard2Answer: "4",
                notesTitle: "Apuntes de Estudio",
                biologyNoteTitle: "Biología: La Célula",
                biologyNoteContent1: "La célula es la unidad fundamental de la vida. Todos los organismos vivos, desde las bacterias más pequeñas hasta las ballenas más grandes, están compuestos por células. Las células son los bloques de construcción básicos y realizan todas las funciones esenciales necesarias para la vida, como la obtención de nutrientes, su conversión en energía y la reproducción.",
                biologyNoteContent2: "Existen dos tipos principales de células: procariotas y eucariotas. Las células procariotas son más simples y antiguas, carecen de núcleo y de otros orgánulos unidos a membranas. Las bacterias y las arqueas son ejemplos de procariotas. Las células eucariotas, por otro lado, son más complejas, poseen un núcleo verdadero que alberga su material genético y varios orgánulos especializados.",
                biologyNoteContent3: "Los orgánulos clave en las células eucariotas incluyen el núcleo, que controla el crecimiento y la reproducción celular; las mitocondrias, a menudo llamadas las 'centrales energéticas' de la célula, responsables de la producción de energía (ATP); el retículo endoplasmático (RE), implicado en la síntesis de proteínas y lípidos; y el aparato de Golgi, que modifica, clasifica y empaqueta proteínas y lípidos.",
                biologyNoteContent4: "La membrana celular actúa como una barrera protectora que regula lo que entra y sale de la célula. Está compuesta por una bicapa lipídica con proteínas incrustadas, lo que le da una estructura de 'mosaico fluido'. Esta permeabilidad selectiva es crucial para mantener el ambiente interno de la célula.",
                biologyNoteContent5: "La división celular es un proceso vital. En los organismos multicelulares, permite el crecimiento y la reparación de tejidos dañados. En los organismos unicelulares, es el método principal de reproducción. La mitosis es la forma más común de división celular para el crecimiento y la reparación, mientras que la meiosis está especializada en la reproducción sexual.",
                quizTitle: "Mini Cuestionario",
                quizStartButton: "Iniciar Cuestionario",
                quizNextButton: "Siguiente Pregunta",
                quizSubmitButton: "Enviar Respuesta",
                quizRetakeButton: "Volver a Intentar Cuestionario",
                quizInputPlaceholder: "Tu respuesta",
                quizCorrect: "¡Correcto!",
                quizIncorrect: "Incorrecto. La respuesta era ",
                quizCompleted: "¡Cuestionario Completado! Obtuviste ",
                quizOutOf: " de ",
                quizQ1: "¿Cuáles son los dos tipos principales de células?",
                quizA1: "Procariotas y eucariotas",
                quizQ2: "¿Qué orgánulo se conoce como la 'central energética' de la célula?",
                quizA2: "Mitocondria",
                quizQ3: "¿Qué controla el crecimiento y la reproducción celular?",
                quizA3: "Núcleo",
                quizQ4: "¿Cuál es la función principal de la membrana celular?",
                quizA4: "Regula lo que entra y sale de la célula",
                quizQ5: "¿Cuál es la forma más común de división celular para el crecimiento y la reparación?",
                quizA5: "Mitosis",
                downloadsTitle: "Descargables",
                downloadLink: "📄 Descargar Apuntes de Ejemplo",
                footerText: "© 2025 Centro de Estudio",
                quizGoBackButton: "Volver" // NEW TRANSLATION
            },
            fr: {
                pageTitle: "Centre d'Étude",
                appTitle: "📚 Centre d'Étude",
                darkModeButton: "Mode Sombre",
                searchInputPlaceholder: "Rechercher des ressources...",
                flashcardsTitle: "Cartes Mémoire",
                flashcard1Question: "Quelle est la capitale de la France ?",
                flashcard1Answer: "Paris",
                flashcard2Question: "2 + 2 = ?",
                flashcard2Answer: "4",
                notesTitle: "Notes d'Étude",
                biologyNoteTitle: "Biologie : La Cellule",
                biologyNoteContent1: "La cellule est l'unité fondamentale de la vie. Tous les organismes vivants, des plus petites bactéries aux plus grandes baleines, sont composés de cellules. Les cellules sont les éléments constitutifs de base et elles remplissent toutes les fonctions essentielles nécessaires à la vie, telles que l'obtention de nutriments, leur conversion en énergie et la reproduction.",
                biologyNoteContent2: "Il existe deux principaux types de cellules : procaryotes et eucaryotes. Les cellules procaryotes sont plus simples et plus anciennes, dépourvues de noyau et d'autres organites liés à la membrane. Les bactéries et les archées sont des exemples de procaryotes. Les cellules eucaryotes, en revanche, sont plus complexes, possédant un véritable noyau qui abrite leur matériel génétique et divers organites spécialisés.",
                biologyNoteContent3: "Les organites clés des cellules eucaryotes comprennent le noyau, qui contrôle la croissance et la reproduction cellulaire ; les mitochondries, souvent appelées les « centrales électriques » de la cellule, responsables de la production d'énergie (ATP) ; le réticulum endoplasmique (RE), impliqué dans la synthèse des protéines et des lipides ; et l'appareil de Golgi, qui modifie, trie et emballe les protéines et les lipides.",
                biologyNoteContent4: "La membrane cellulaire agit comme une barrière protectrice qui régule ce qui entre et sort de la cellule. Elle est composée d'une bicouche lipidique avec des protéines intégrées, lui donnant une structure en « mosaïque fluide ». Cette perméabilité sélective est cruciale pour maintenir l'environnement interne de la cellule.",
                biologyNoteContent5: "La division cellulaire est un processus vital. Chez les organismes multicellulaires, elle permet la croissance et la réparation des tissus endommagés. Chez les organismes unicellulaires, c'est la principale méthode de reproduction. La mitose est la forme la plus courante de division cellulaire pour la croissance et la réparation, tandis que la méiose est spécialisée dans la reproduction sexuelle.",
                quizTitle: "Mini Quizz",
                quizStartButton: "Démarrer le Quizz",
                quizNextButton: "Question Suivante",
                quizSubmitButton: "Soumettre la Réponse",
                quizRetakeButton: "Reprendre le Quizz",
                quizInputPlaceholder: "Votre réponse",
                quizCorrect: "Correct !",
                quizIncorrect: "Incorrect. La réponse était ",
                quizCompleted: "Quizz Terminé ! Vous avez obtenu ",
                quizOutOf: " sur ",
                quizQ1: "Quels sont les deux principaux types de cellules ?",
                quizA1: "Procaryotes et eucaryotes",
                quizQ2: "Quel organite est connu comme la 'centrale électrique' de la cellule ?",
                quizA2: "Mitochondrie",
                quizQ3: "Qu'est-ce qui contrôle la croissance et la reproduction cellulaire ?",
                quizA3: "Noyau",
                quizQ4: "Quelle est la fonction principale de la membrane cellulaire ?",
                quizA4: "Régule ce qui entre et sort de la cellule",
                quizQ5: "Quelle est la forme la plus courante de division cellulaire pour la croissance et la réparation ?",
                quizA5: "Mitose",
                downloadsTitle: "Téléchargeables",
                downloadLink: "📄 Télécharger des Notes d'Exemple",
                footerText: "© 2025 Centre d'Étude",
                quizGoBackButton: "Retour" // NEW TRANSLATION
            },
            de: {
                pageTitle: "Studienzentrum",
                appTitle: "📚 Studienzentrum",
                darkModeButton: "Dunkler Modus",
                searchInputPlaceholder: "Ressourcen suchen...",
                flashcardsTitle: "Lernkarten",
                flashcard1Question: "Was ist die Hauptstadt von Frankreich?",
                flashcard1Answer: "Paris",
                flashcard2Question: "2 + 2 = ?",
                flashcard2Answer: "4",
                notesTitle: "Studiennotizen",
                biologyNoteTitle: "Biologie: Die Zelle",
                biologyNoteContent1: "Die Zelle ist die grundlegende Einheit des Lebens. Alle Lebewesen, von den kleinsten Bakterien bis zu den größten Walen, bestehen aus Zellen. Zellen sind die grundlegenden Bausteine und führen alle wesentlichen Funktionen aus, die für das Leben notwendig sind, wie die Aufnahme von Nährstoffen, deren Umwandlung in Energie und die Reproduktion.",
                biologyNoteContent2: "Es gibt zwei Haupttypen von Zellen: Prokaryoten und Eukaryoten. Prokaryotische Zellen sind einfacher und älter, ihnen fehlen ein Zellkern und andere membranumschlossene Organellen. Bakterien und Archaeen sind Beispiele für Prokaryoten. Eukaryotische Zellen hingegen sind komplexer und besitzen einen echten Zellkern, der ihr genetisches Material beherbergt, sowie verschiedene spezialisierte Organellen.",
                biologyNoteContent3: "Zu den Schlüsselorganellen in eukaryotischen Zellen gehören der Zellkern, der das Zellwachstum und die Reproduktion steuert; Mitochondrien, oft als 'Kraftwerke' der Zelle bezeichnet, die für die Energieproduktion (ATP) verantwortlich sind; das endoplasmatische Retikulum (ER), das an der Protein- und Lipidsynthese beteiligt ist; und der Golgi-Apparat, der Proteine und Lipide modifiziert, sortiert und verpackt.",
                biologyNoteContent4: "Die Zellmembran fungiert als Schutzbarriere, die reguliert, was in die Zelle hinein- und herausgelangt. Sie besteht aus einer Lipiddoppelschicht mit eingelagerten Proteinen, was ihr eine 'flüssiges Mosaik'-Struktur verleiht. Diese selektive Permeabilität ist entscheidend für die Aufrechterhaltung des internen Milieus der Zelle.",
                biologyNoteContent5: "Zellteilung ist ein lebenswichtiger Prozess. Bei mehrzelligen Organismen ermöglicht sie Wachstum und die Reparatur beschädigter Gewebe. Bei einzelligen Organismen ist sie die primäre Methode der Reproduktion. Mitose ist die häufigste Form der Zellteilung für Wachstum und Reparatur, während Meiose auf sexuelle Reproduktion spezialisiert ist.",
                quizTitle: "Mini Quiz",
                quizStartButton: "Quiz starten",
                quizNextButton: "Nächste Frage",
                quizSubmitButton: "Antwort senden",
                quizRetakeButton: "Quiz wiederholen",
                quizInputPlaceholder: "Ihre Antwort",
                quizCorrect: "Richtig!",
                quizIncorrect: "Falsch. Die Antwort war ",
                quizCompleted: "Quiz abgeschlossen! Sie haben ",
                quizOutOf: " von ",
                quizQ1: "Was sind die zwei Hauptzelltypen?",
                quizA1: "Prokaryoten und Eukaryoten",
                quizQ2: "Welches Organell ist als 'Kraftwerk' der Zelle bekannt?",
                quizA2: "Mitochondrien",
                quizQ3: "Was steuert Zellwachstum und -reproduktion?",
                quizA3: "Zellkern",
                quizQ4: "Was ist die Hauptfunktion der Zellmembran?",
                quizA4: "Reguliert, was in die Zelle hinein- und herausgelangt",
                quizQ5: "Was ist die häufigste Form der Zellteilung für Wachstum und Reparatur?",
                quizA5: "Mitose",
                downloadsTitle: "Downloads",
                downloadLink: "📄 Beispielnotizen herunterladen",
                footerText: "© 2025 Studienzentrum",
                quizGoBackButton: "Zurück" // NEW TRANSLATION
            },
            it: {
                pageTitle: "Centro di Studio",
                appTitle: "📚 Centro di Studio",
                darkModeButton: "Modalità Scura",
                searchInputPlaceholder: "Cerca risorse...",
                flashcardsTitle: "Flashcard",
                flashcard1Question: "Qual è la capitale della Francia?",
                flashcard1Answer: "Parigi",
                flashcard2Question: "2 + 2 = ?",
                flashcard2Answer: "4",
                notesTitle: "Appunti di Studio",
                biologyNoteTitle: "Biologia: La Cellula",
                biologyNoteContent1: "La cellula è l'unità fondamentale della vita. Tutti gli organismi viventi, dai batteri più piccoli alle balene più grandi, sono composti da cellule. Le cellule sono i blocchi costruttivi di base e svolgono tutte le funzioni essenziali necessarie per la vita, come ottenere nutrienti, convertirli in energia e riprodursi.",
                biologyNoteContent2: "Esistono due tipi principali di cellule: procariotiche ed eucariotiche. Le cellule procariotiche sono più semplici e antiche, prive di nucleo e di altri organelli legati alla membrana. Batteri e archei sono esempi di procarioti. Le cellule eucariotiche, d'altra parte, sono più complesse, possiedono un vero nucleo che ospita il loro materiale genetico e vari organelli specializzati.",
                biologyNoteContent3: "Gli organelli chiave nelle cellule eucariotiche includono il nucleo, che controlla la crescita e la riproduzione cellulare; i mitocondri, spesso chiamati le 'centrali energetiche' della cellula, responsabili della produzione di energia (ATP); il reticolo endoplasmatico (RE), coinvolto nella sintesi di proteine e lipidi; e l'apparato di Golgi, che modifica, smista e impacchetta proteine e lipidi.",
                biologyNoteContent4: "La membrana cellulare agisce come una barriera protettiva che regola ciò che entra ed esce dalla cellula. È composta da un doppio strato lipidico con proteine incorporate, conferendole una struttura a 'mosaico fluido'. Questa permeabilità selettiva è cruciale per mantenere l'ambiente interno della cellula.",
                biologyNoteContent5: "La divisione cellulare è un processo vitale. Negli organismi multicellulari, consente la crescita e la riparazione dei tessuti danneggiati. Negli organismi unicellulari, è il metodo principale di riproduzione. La mitosi è la forma più comune di divisione cellulare per la crescita e la riparazione, mentre la meiosi è specializzata per la riproduzione sessuale.",
                quizTitle: "Mini Quiz",
                quizStartButton: "Inizia Quiz",
                quizNextButton: "Prossima Domanda",
                quizSubmitButton: "Invia Risposta",
                quizRetakeButton: "Riprova Quiz",
                quizInputPlaceholder: "La tua risposta",
                quizCorrect: "Corretto!",
                quizIncorrect: "Non corretto. La risposta era ",
                quizCompleted: "Quiz Completato! Hai totalizzato ",
                quizOutOf: " su ",
                quizQ1: "Quali sono i due tipi principali di cellule?",
                quizA1: "Procariotiche ed eucariotiche",
                quizQ2: "Quale organello è conosciuto come la 'centrali energetica' della cellula?",
                quizA2: "Mitocondri",
                quizQ3: "Cosa controlla la crescita e la riproduzione cellulare?",
                quizA3: "Nucleo",
                quizQ4: "Qual è la funzione principale della membrana cellulare?",
                quizA4: "Regola ciò che entra ed esce dalla cellula",
                quizQ5: "Qual è la forma più comune di divisione cellulare per la crescita e la riparazione?",
                quizA5: "Mitosi",
                downloadsTitle: "Scaricabili",
                downloadLink: "📄 Scarica Appunti di Esempio",
                footerText: "© 2025 Centro di Studio",
                quizGoBackButton: "Torna Indietro" // NEW TRANSLATION
            }
        };

        // --- DOM Elements ---
        const body = document.body;
        const darkModeToggle = document.getElementById('darkModeToggle');
        const languageSelector = document.getElementById('languageSelector');
        const searchInput = document.getElementById('searchInput');

        const flashcardsSection = document.getElementById('flashcards');
        const notesSection = document.getElementById('notes');
        const quizSection = document.getElementById('quiz');
        const downloadsSection = document.getElementById('downloads');

        const flashcardElements = document.querySelectorAll('.card');

        const quizQuestionDisplay = document.getElementById('quizQuestionDisplay');
        const quizAnswerInput = document.getElementById('quizAnswerInput');
        const quizActionButton = document.getElementById('quizActionButton');
        const quizFeedback = document.getElementById('quizFeedback');
        const quizGoBackButton = document.getElementById('quizGoBackButton'); // Get the new button

        // --- State Variables ---
        let currentLanguage = localStorage.getItem('language') || 'en';
        let isDarkMode = localStorage.getItem('darkMode') === 'true';

        const quizQuestions = [
            { questionKey: 'quizQ1', answerKey: 'quizA1' },
            { questionKey: 'quizQ2', answerKey: 'quizA2' },
            { questionKey: 'quizQ3', answerKey: 'quizA3' },
            { questionKey: 'quizQ4', answerKey: 'quizA4' },
            { questionKey: 'quizQ5', answerKey: 'quizA5' }
        ];
        let currentQuizQuestionIndex = 0;
        let score = 0;
        let quizActive = false; // Track if the quiz is currently running

        // --- Functions ---

        function applyTheme() {
            if (isDarkMode) {
                body.classList.add('dark');
                darkModeToggle.textContent = translations[currentLanguage].darkModeButton.replace('Dark Mode', 'Light Mode'); // Update button text
            } else {
                body.classList.remove('dark');
                darkModeToggle.textContent = translations[currentLanguage].darkModeButton;
            }
        }

        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            document.querySelector('[data-i18n="pageTitle"]').textContent = translations[lang].pageTitle;
            document.querySelector('[data-i18n="appTitle"]').textContent = translations[lang].appTitle;
            document.querySelector('[data-i18n="darkModeButton"]').textContent = isDarkMode ? translations[lang].darkModeButton.replace('Dark Mode', 'Light Mode') : translations[lang].darkModeButton;
            document.querySelector('[data-i18n="searchInputPlaceholder"]').setAttribute('placeholder', translations[lang].searchInputPlaceholder);
            document.querySelector('[data-i18n="flashcardsTitle"]').textContent = translations[lang].flashcardsTitle;
            document.querySelector('[data-i18n="flashcard1Question"]').textContent = translations[lang].flashcard1Question;
            document.querySelector('[data-i18n="flashcard1Answer"]').textContent = translations[lang].flashcard1Answer;
            document.querySelector('[data-i18n="flashcard2Question"]').textContent = translations[lang].flashcard2Question;
            document.querySelector('[data-i18n="flashcard2Answer"]').textContent = translations[lang].flashcard2Answer;
            document.querySelector('[data-i18n="notesTitle"]').textContent = translations[lang].notesTitle;
            document.querySelector('[data-i18n="biologyNoteTitle"]').textContent = translations[lang].biologyNoteTitle;
            document.querySelector('[data-i18n="biologyNoteContent1"]').textContent = translations[lang].biologyNoteContent1;
            document.querySelector('[data-i18n="biologyNoteContent2"]').textContent = translations[lang].biologyNoteContent2;
            document.querySelector('[data-i18n="biologyNoteContent3"]').textContent = translations[lang].biologyNoteContent3;
            document.querySelector('[data-i18n="biologyNoteContent4"]').textContent = translations[lang].biologyNoteContent4;
            document.querySelector('[data-i18n="biologyNoteContent5"]').textContent = translations[lang].biologyNoteContent5;
            document.querySelector('[data-i18n="quizTitle"]').textContent = translations[lang].quizTitle;
            document.querySelector('[data-i18n="quizInputPlaceholder"]').setAttribute('placeholder', translations[lang].quizInputPlaceholder);
            document.querySelector('[data-i18n="downloadsTitle"]').textContent = translations[lang].downloadsTitle;
            document.querySelector('[data-i18n="downloadLink"]').textContent = translations[lang].downloadLink;
            document.querySelector('[data-i18n="footerText"]').textContent = translations[lang].footerText;

            // Update quiz button text based on quiz state
            if (quizActive) {
                quizActionButton.textContent = translations[lang].quizSubmitButton;
            } else {
                quizActionButton.textContent = translations[lang].quizStartButton;
            }
            // Update quiz question if quiz is active
            if (quizActive && currentQuizQuestionIndex < quizQuestions.length) {
                quizQuestionDisplay.textContent = translations[lang][quizQuestions[currentQuizQuestionIndex].questionKey];
            } else if (quizActive && currentQuizQuestionIndex >= quizQuestions.length) {
                 // This case handles the "Quiz Completed" state
                quizQuestionDisplay.textContent = `${translations[lang].quizCompleted} ${score} ${translations[lang].quizOutOf} ${quizQuestions.length}.`;
                quizActionButton.textContent = translations[lang].quizRetakeButton;
            } else {
                quizQuestionDisplay.textContent = ""; // Clear question if not in quiz
            }

            quizGoBackButton.textContent = translations[lang].quizGoBackButton; // Update go back button text
        }

        // NEW FUNCTION: Toggles visibility of quiz elements
        function showQuizElements(show) {
            quizQuestionDisplay.style.display = show ? 'block' : 'none';
            quizAnswerInput.style.display = show ? 'block' : 'none';
            quizFeedback.style.display = show ? 'flex' : 'none'; // Keep as flex for centering
            quizActionButton.style.display = show ? 'block' : 'none';
            quizGoBackButton.style.display = show ? 'block' : 'none'; // Show/hide the go back button
        }

        // NEW FUNCTION: Shows all main content sections
        function showAllSections() {
            flashcardsSection.style.display = 'block';
            notesSection.style.display = 'block';
            quizSection.style.display = 'block';
            downloadsSection.style.display = 'block';
        }

        // NEW FUNCTION: Hides all sections except the quiz
        function hideAllSectionsExceptQuiz() {
            flashcardsSection.style.display = 'none';
            notesSection.style.display = 'none';
            downloadsSection.style.display = 'none';
        }


        function startQuiz() {
            quizActive = true;
            currentQuizQuestionIndex = 0;
            score = 0;
            quizFeedback.textContent = '';
            quizAnswerInput.value = '';
            quizAnswerInput.classList.remove('text-green', 'text-red');
            quizFeedback.classList.remove('text-green', 'text-red');

            hideAllSectionsExceptQuiz(); // Hide other sections
            showQuizElements(true); // Show quiz specific elements
            // quizGoBackButton.style.display = 'block'; // This is now handled by showQuizElements(true)

            displayQuizQuestion();
            quizActionButton.textContent = translations[currentLanguage].quizSubmitButton;
            quizAnswerInput.focus();
        }

        function displayQuizQuestion() {
            if (currentQuizQuestionIndex < quizQuestions.length) {
                const questionKey = quizQuestions[currentQuizQuestionIndex].questionKey;
                quizQuestionDisplay.textContent = translations[currentLanguage][questionKey];
                quizAnswerInput.value = ''; // Clear previous answer
                quizFeedback.textContent = ''; // Clear feedback
                quizFeedback.classList.remove('text-green', 'text-red');
                quizAnswerInput.style.backgroundColor = 'var(--input-bg)'; // Reset input background
                quizAnswerInput.focus();
                quizActionButton.textContent = translations[currentLanguage].quizSubmitButton; // Ensure button says Submit
            } else {
                endQuiz();
            }
        }

        function checkQuizAnswer() {
            if (currentQuizQuestionIndex >= quizQuestions.length) {
                // This means the quiz has ended and the button now says "Retake Quiz"
                startQuiz();
                return;
            }

            const userAnswer = quizAnswerInput.value.trim().toLowerCase();
            const correctAnswerKey = quizQuestions[currentQuizQuestionIndex].answerKey;
            const correctAnswer = translations[currentLanguage][correctAnswerKey].toLowerCase();

            if (userAnswer === correctAnswer) {
                quizFeedback.textContent = translations[currentLanguage].quizCorrect;
                quizFeedback.classList.add('text-green');
                quizFeedback.classList.remove('text-red');
                quizAnswerInput.classList.add('text-green');
                quizAnswerInput.classList.remove('text-red');
                score++;
            } else {
                quizFeedback.textContent = translations[currentLanguage].quizIncorrect + translations[currentLanguage][correctAnswerKey] + ".";
                quizFeedback.classList.add('text-red');
                quizFeedback.classList.remove('text-green');
                quizAnswerInput.classList.add('text-red');
                quizAnswerInput.classList.remove('text-green');
            }

            currentQuizQuestionIndex++;
            // Change button to "Next Question" or "Retake Quiz"
            if (currentQuizQuestionIndex < quizQuestions.length) {
                quizActionButton.textContent = translations[currentLanguage].quizNextButton;
            } else {
                quizActionButton.textContent = translations[currentLanguage].quizRetakeButton;
            }
        }

        function endQuiz() {
            quizActive = false;
            quizQuestionDisplay.textContent = `${translations[currentLanguage].quizCompleted} ${score} ${translations[currentLanguage].quizOutOf} ${quizQuestions.length}.`;
            quizAnswerInput.style.display = 'none'; // Hide input when quiz is done
            quizFeedback.textContent = ''; // Clear feedback
            quizFeedback.classList.remove('text-green', 'text-red');
            quizActionButton.textContent = translations[currentLanguage].quizRetakeButton;
        }

        // NEW FUNCTION: Resets quiz and returns to main page view
        function goToMainPage() {
            quizActive = false; // Reset quiz active state
            currentQuizQuestionIndex = 0; // Reset question index
            score = 0; // Reset score
            quizFeedback.textContent = ''; // Clear feedback
            quizAnswerInput.value = ''; // Clear input
            quizAnswerInput.classList.remove('text-green', 'text-red');
            quizFeedback.classList.remove('text-green', 'text-red');
            quizQuestionDisplay.textContent = ''; // Clear question display

            showAllSections(); // Show all main sections
            showQuizElements(false); // Hide quiz specific elements
            quizActionButton.textContent = translations[currentLanguage].quizStartButton; // Reset button text
            // quizGoBackButton.style.display = 'none'; // This is now handled by showQuizElements(false)
        }


        // --- Event Listeners ---

        darkModeToggle.addEventListener('click', () => {
            isDarkMode = !isDarkMode;
            localStorage.setItem('darkMode', isDarkMode);
            applyTheme();
        });

        languageSelector.addEventListener('change', (event) => {
            setLanguage(event.target.value);
        });

        flashcardElements.forEach(card => {
            card.addEventListener('click', () => {
                card.querySelector('.answer').style.display = card.querySelector('.answer').style.display === 'block' ? 'none' : 'block';
            });
        });

        quizActionButton.addEventListener('click', () => {
            if (!quizActive) { // If quiz is not active, start it
                startQuiz();
            } else { // If quiz is active, check the answer or move to next question
                checkQuizAnswer();
            }
        });

        quizGoBackButton.addEventListener('click', goToMainPage); // NEW EVENT LISTENER for the go back button

        searchInput.addEventListener('keyup', (event) => {
            const searchTerm = event.target.value.toLowerCase();

            // Hide/show sections based on search term
            const sections = [flashcardsSection, notesSection, quizSection, downloadsSection];
            sections.forEach(section => {
                const sectionText = section.textContent.toLowerCase();
                if (sectionText.includes(searchTerm)) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });

            // Special handling for quiz section if search is active
            if (searchTerm.includes('quiz') && !quizActive) {
                quizSection.style.display = 'block'; // Ensure quiz section is visible if searched
            } else if (searchTerm.includes('quiz') && quizActive) {
                // If quiz is active and user searches for quiz, keep only quiz visible
                hideAllSectionsExceptQuiz();
            } else if (!searchTerm) { // If search term is empty, show all sections and reset quiz view if necessary
                if (!quizActive) {
                    showAllSections();
                } else {
                    hideAllSectionsExceptQuiz(); // Still hide others if quiz is active
                }
            }
        });


        // --- Initial Setup ---
        document.addEventListener('DOMContentLoaded', () => {
            // Set initial language from localStorage or default to 'en'
            languageSelector.value = currentLanguage;
            setLanguage(currentLanguage);
            applyTheme();

            // Initially hide quiz specific elements until quiz starts
            showQuizElements(false);
            // Ensure all main sections are visible on load
            showAllSections();
        });
    </script>
</body>
</html>
